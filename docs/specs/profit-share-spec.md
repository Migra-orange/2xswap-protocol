# Profit Share Module – Technical Specification

## Overview
The Profit Share Module defines how profits generated by an A-position (Initiator)
are split between A and B based on the utilization of the liquidity pool.

The module outputs two values (all in 1e18 precision):
- shareA
- shareB

Invariant:
shareA + shareB = 1e18


## Input: utilization (uint256, 1e18 precision)

Ranges:
- 0%  = 0
- 50% = 0.5e18
- 100% = 1e18

The module MUST revert if utilization > 1e18.


## Threshold Model (Piecewise Split)

| Utilization | Mode        | Split A:B |
|------------|-------------|-----------|
| 0–90%      | Normal      | 80 : 20   |
| 90–92%     | Pre-Stress  | 70 : 30   |
| 92–94%     | Overload    | 60 : 40   |
| >94%       | Critical    | 50 : 50   |


## Output Format

Outputs must be returned in 1e18 precision.

Examples:
- 80% = 0.8e18 = 800000000000000000
- 20% = 0.2e18 = 200000000000000000

Invariant:
shareA + shareB = 1e18


## Constraints

- No storage
- No external calls
- Pure deterministic function
- Gas-efficient branching
- Use constants for thresholds and ratios


## Recommended Function Signature

function calculateProfitShare(
    uint256 utilization
) internal pure returns (uint256 shareA, uint256 shareB);


## Unit Test Requirements

Tests MUST include:
- All threshold boundaries
- Correct splits per range
- Random values within each range
- Invariant validation (shareA + shareB == 1e18)
- Revert for invalid utilization (>1e18)


## Future Extensions

- Curve-based dynamic model
- Protocol-wide adjustable thresholds
